<div class="container">
  <h1>{{assignment ? assignment.title : 'Loading...'}}</h1>
  <p class="text-muted">
    <ng-container *ngIf="assignment">
      by {{assignment.author}}
      &mdash;
      <a href="mailto:{{assignment.email}}">{{assignment.email}}</a>
      &mdash;
      Deadline: {{assignment.deadline | date:'medium'}}
    </ng-container>
    <ng-container *ngIf="!assignment">
      Loading...
    </ng-container>
  </p>

  <p *ngIf="assignment" [innerHTML]="assignment.descriptionHtml | safeHtml">
  </p>
  <p *ngIf="!assignment">
    Loading Description...
  </p>

  <h2>Tasks</h2>
  <ol *ngIf="assignment">
    <li *ngFor="let task of assignment.tasks; let i = index">
      {{task.description}}
      <span class="badge badge-secondary">
        {{task.points}}
      </span>
    </li>
  </ol>
  <p *ngIf="!assignment">
    Loading Tasks...
  </p>

  <h2>Solutions</h2>
  <div class="form-inline mb-3">
    <label for="searchInput" class="mr-sm-2">Search:</label>
    <input type="text" class="form-control mr-sm-2" id="searchInput" placeholder="Name, Student ID, E-Mail, Assignee"
           [(ngModel)]="searchText" (change)="updateSearch()">
    <ng-container *ngIf="solutions && filteredSolutions && solutions.length != filteredSolutions.length">
      Showing {{filteredSolutions.length}} of {{solutions.length}} solutions.
    </ng-container>
  </div>
  <table class="table table-bordered table-hover" *ngIf="solutions">
    <thead>
    <tr>
      <th>Name</th>
      <th>Student ID</th>
      <th>E-Mail</th>
      <th>Submitted</th>
      <th>Points</th>
      <th>Assignee</th>
      <th>Actions</th>
    </tr>
    </thead>
    <tbody>
      <tr *ngFor="let solution of filteredSolutions">
        <td>{{solution.name}}</td>
        <td>{{solution.studentID}}</td>
        <td><a href="mailto:{{solution.email}}">{{solution.email}}</a></td>
        <td>{{solution.timeStamp | date:'medium'}}</td>
        <td><span class="badge badge-primary badge-pill">
          {{totalResultPoints(solution)}} / {{totalPoints}}
        </span></td>
        <td><input class="form-control" #assigneeInput
                   [ngModel]="solution.assignee" (change)="setAssignee(solution, assigneeInput)"></td>
        <td><a routerLink="/assignments/{{assignmentID}}/solutions/{{solution.id}}">View</a></td>
      </tr>
    </tbody>
  </table>
  <p *ngIf="!solutions">
    Loading Solutions...
  </p>
</div>
