<div class="file-item" (click)="open()" (contextmenu)="openContextMenu($event, dropdown)">
  <div class="file-item-indent" [style.margin-left.em]="level - 0.5">
    <app-file-icon class="mr-2" [file]="root" [open]="expanded"></app-file-icon>
    <input *ngIf="newName"
           type="text" class="name-input flex-grow-1" aria-label="New Name"
           (click)="$event.stopImmediatePropagation()"
           (change)="finishRenaming()"
           (keyup.escape)="cancelRenaming()"
           [(ngModel)]="newName"
    >
    <div *ngIf="!newName" class="flex-grow-1">
      {{root.name}}
      <span class="text-muted" *ngIf="root.info">
        {{root.info}}
      </span>
    </div>
    <div ngbDropdown #dropdown="ngbDropdown" (click)="$event.stopImmediatePropagation()">
      <span class="dropdown-dots font-weight-bolder px-2" (click)="dropdown.toggle()">
        &#8942;
      </span>
      <div ngbDropdownMenu>
        <button ngbDropdownItem (click)="open()">Open</button>
        <button ngbDropdownItem (click)="startRenaming()">Rename</button>
        <div class="dropdown-divider"></div>
        <button ngbDropdownItem class="text-danger" (click)="delete()">Delete</button>
      </div>
    </div>
  </div>
</div>
<ng-container *ngIf="expanded">
  <app-file-tree *ngFor="let child of root.children || []" [root]="child" [level]="level + 1" [handler]="handler"></app-file-tree>
</ng-container>
