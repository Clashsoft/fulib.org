<table class="table table-hover table-bordered table-sm table-responsive">
  <thead>
  <tr>
    <th *ngFor="let prop of authorProperties">
      {{ prop[0] }}
    </th>
    <th *ngFor="let name of assignmentNames" colspan="2">
      {{ name }}
    </th>
    <th>
      <i class="bi-person-raised-hand" ngbTooltip="Number of complete Feedbacks submitted"></i>
    </th>
  </tr>
  </thead>
  <tbody>
  <tr *ngIf="!students">
    <td [attr.colspan]="authorProperties.length + assignmentNames.length * 2" class="text-center align-middle">
      <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
      Loading...
    </td>
  </tr>
  <tr *ngFor="let student of students">
    <td *ngFor="let prop of authorProperties">
      {{ student.author[prop[1]] }}
    </td>
    <ng-container *ngFor="let solution of student.solutions; let i = index">
      <td class="text-end" [class.text-danger]="!solution" [class.text-muted]="solution && solution.points === undefined">
        {{ solution?.points || 0 }}
      </td>
      <td [style.background-color]="solution?.assignee | assigneeColor">
        <div ngbDropdown>
          <button ngbDropdownToggle class="btn p-0 text-white text-shadow">{{ (solution?.assignee || '-') | initials }}</button>
          <div ngbDropdownMenu>
            <ng-container *ngIf="solution else noSolution">
              <a
                ngbDropdownItem
                class="bi-list-check"
                [routerLink]="['/assignments', course?.assignments?.[i], 'solutions', solution._id]"
              >
                View Solution
              </a>
              <div class="dropdown-item-text">
                <label class="form-label bi-person-check">
                  Assignee
                </label>
                <app-assignee-input
                  #assigneeInput
                  [assignment]="course?.assignments?.[i]!"
                  [solution]="solution._id!"
                  [assignees]="assignees"
                  [(assignee)]="solution.assignee"
                ></app-assignee-input>
                <div class="btn-group">
                  <button
                    *ngFor="let assignee of assignees"
                    class="btn btn-sm text-white text-shadow"
                    [ngbTooltip]="assignee"
                    [style.background-color]="assignee | assigneeColor"
                    (click)="assigneeInput.assignee = assignee; assigneeInput.save()"
                  >
                    {{ assignee | initials }}
                  </button>
                </div>
              </div>
            </ng-container>
            <ng-template #noSolution>
              <div class="dropdown-item-text text-muted">
                No Solution
              </div>
            </ng-template>
          </div>
        </div>
      </td>
    </ng-container>
    <td>
      {{ student.feedbacks }}
    </td>
  </tr>
  </tbody>
</table>
